---
import ThemeToggle from './ThemeToggle';
import Logo from './Logo';

const base = import.meta.env.BASE_URL;
const isHome = Astro.url.pathname === base || Astro.url.pathname === `${base}` || Astro.url.pathname === `${base.replace(/\/$/, '')}/`;
---

<header class="fixed top-0 left-0 right-0 z-40 backdrop-blur-md bg-light-bg/80 dark:bg-dark-bg/80 border-b border-light-border dark:border-dark-border">
  <nav class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
    <div class="flex items-center justify-between">
      <a 
        href={base}
        class="flex items-center hover:opacity-80 transition-opacity"
        aria-label="Home"
      >
        <Logo client:load />
      </a>
      
      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center gap-6">
        <a 
          href={isHome ? '#about' : `${base}#about`}
          class="text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary hover:text-light-accent dark:hover:text-dark-accent transition-colors"
        >
          About
        </a>
        <a 
          href={isHome ? '#skills' : `${base}#skills`}
          class="text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary hover:text-light-accent dark:hover:text-dark-accent transition-colors"
        >
          Skills
        </a>
        <a 
          href={isHome ? '#exploring' : `${base}#exploring`}
          class="text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary hover:text-light-accent dark:hover:text-dark-accent transition-colors"
        >
          Exploring
        </a>
        <a 
          href={isHome ? '#blog' : `${base}#blog`}
          class="text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary hover:text-light-accent dark:hover:text-dark-accent transition-colors"
        >
          Blog
        </a>
        
        <ThemeToggle client:load />
      </div>

      <!-- Mobile Menu Button and Theme Toggle -->
      <div class="flex md:hidden items-center gap-4">
        <ThemeToggle client:load />
        <button 
          id="mobile-menu-button"
          class="text-light-text dark:text-dark-text hover:text-light-accent dark:hover:text-dark-accent transition-colors"
          aria-label="Toggle menu"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4 space-y-3">
      <a 
        href={isHome ? '#about' : `${base}#about`}
        class="block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary hover:text-light-accent dark:hover:text-dark-accent transition-colors"
      >
        About
      </a>
      <a 
        href={isHome ? '#skills' : `${base}#skills`}
        class="block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary hover:text-light-accent dark:hover:text-dark-accent transition-colors"
      >
        Skills
      </a>
      <a 
        href={isHome ? '#exploring' : `${base}#exploring`}
        class="block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary hover:text-light-accent dark:hover:text-dark-accent transition-colors"
      >
        Exploring
      </a>
      <a 
        href={isHome ? '#blog' : `${base}#blog`}
        class="block text-sm font-medium text-light-textSecondary dark:text-dark-textSecondary hover:text-light-accent dark:hover:text-dark-accent transition-colors"
      >
        Blog
      </a>
    </div>
  </nav>
</header>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  mobileMenuButton?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });

  // Close mobile menu when clicking a link
  const mobileLinks = mobileMenu?.querySelectorAll('a');
  mobileLinks?.forEach(link => {
    link.addEventListener('click', () => {
      mobileMenu?.classList.add('hidden');
    });
  });
</script>
